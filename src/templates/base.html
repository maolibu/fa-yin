<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="/static/images/favicon.svg">
    <title>{% block title %}æ³•å°å¯¹ç…§ Â· æ•´åˆé˜…è¯»å¹³å°{% endblock %}</title>
    <meta name="description" content="åŸºäº TEI P5 XML åŸæ–‡çš„é«˜ä¿çœŸä½›ç»åœ¨çº¿é˜…è¯» Â· æ³•è„‰æ—¶ç©ºå›¾è°± Â· åŒç»å¼‚è¯‘å¯¹ç…§">
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="/static/js/lib/htmx.min.js"></script>
    <script src="/static/js/lib/split.min.js"></script>
    <script src="/static/js/lib/alpine.min.js" defer></script>
    <script src="/static/js/lib/opencc-full.js"></script>
    {% block head %}{% endblock %}
    <script>
        // åœ¨æ¸²æŸ“å‰åº”ç”¨ä¿å­˜çš„ä¸»é¢˜ï¼Œé˜²æ­¢é—ªçƒ
        (function () {
            if (localStorage.getItem('reader_theme') === 'light') {
                document.documentElement.classList.add('theme-light');
            }
        })();
    </script>
</head>

<body class="{% block body_class %}{% endblock %}">
    <script>
        // åŒæ­¥ body classï¼ˆéƒ¨åˆ† CSS é€‰æ‹©å™¨ç”¨ body.theme-lightï¼‰
        if (document.documentElement.classList.contains('theme-light')) {
            document.body.classList.add('theme-light');
        }
    </script>
    {% block body_content %}
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="top-nav">
        <div class="nav-inner">
            <a href="/" class="nav-brand">
                <span class="brand-icon">
                    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" style="display:block;">
                        <!-- Leaf 1 -->
                        <path d="M18 4c0 0-6 8-6 12s6 12 6 12" />
                        <path d="M18 4c0 0 6 8 6 12s-6 12-6 12" />
                        <!-- Leaf 2 (Overlapping/Offset) -->
                        <path d="M14 8c0 0-6 6-6 10s6 10 6 10" opacity="0.6" />
                        <path d="M14 8c0 0 6 6 6 10s-6 10-6 10" opacity="0.6" />
                    </svg>
                </span>
                <span class="brand-text">æ³•å°å¯¹ç…§</span>
            </a>

            <!-- å¯¼èˆªæ æœç´¢æ¡†ï¼ˆå…¨å±€å¯ç”¨ï¼‰ -->
            <div class="nav-search" x-data="navSearchApp()">
                <div class="nav-search-wrapper">
                    <span class="nav-search-icon">ğŸ”</span>
                    <input type="text" class="nav-search-input" placeholder="æœç´¢ç»åæˆ–ç»æ–‡å†…å®¹â€¦" x-model="query"
                        @input.debounce.300ms="doSearch()" @focus="showResults = results.length > 0"
                        @keydown.escape="showResults = false">
                </div>
                <!-- æœç´¢ç»“æœä¸‹æ‹‰ -->
                <div class="nav-search-results" x-show="showResults && results.length > 0" x-cloak
                    @click.outside="showResults = false">
                    <!-- æ ‡é¢˜åŒ¹é… -->
                    <template x-if="titleResults.length > 0">
                        <div>
                            <div class="search-section-label">ç»ååŒ¹é…</div>
                            <template x-for="r in titleResults" :key="r.sutra_id">
                                <a class="nav-search-result-item" :href="'/read/' + r.sutra_id">
                                    <div class="result-header">
                                        <span class="result-id" x-text="r.sutra_id"></span>
                                        <span class="result-title" x-text="r.title"></span>
                                    </div>
                                </a>
                            </template>
                        </div>
                    </template>
                    <!-- å…¨æ–‡åŒ¹é… -->
                    <template x-if="fulltextResults.length > 0">
                        <div>
                            <div class="search-section-label">å…¨æ–‡åŒ¹é…</div>
                            <template x-for="r in fulltextResults" :key="r.sutra_id + '-' + r.juan">
                                <a class="nav-search-result-item" :href="'/read/' + r.sutra_id + '?juan=' + r.juan">
                                    <div class="result-header">
                                        <span class="result-id" x-text="r.sutra_id"></span>
                                        <span class="result-title" x-text="r.title"></span>
                                        <span class="result-juan" x-text="'å·' + r.juan"></span>
                                    </div>
                                    <div class="result-snippet" x-html="r.snippet"></div>
                                </a>
                            </template>
                        </div>
                    </template>
                </div>
                <!-- æ— ç»“æœ -->
                <div class="nav-search-results nav-search-no-result"
                    x-show="showResults && query.length > 0 && results.length === 0 && !loading" x-cloak
                    @click.outside="showResults = false">
                    <p>æœªæ‰¾åˆ°åŒ¹é…çš„ç»æ–‡</p>
                </div>
            </div>

            <!-- å¯¼èˆªé“¾æ¥å·²ç§»é™¤ï¼Œä»…ä¿ç•™æœç´¢ -->
        </div>
    </nav>

    <main class="main-content">
        {% block content %}{% endblock %}
    </main>
    {% endblock %}

    <!-- é¡µè„š -->
    <footer class="site-footer">
        <p class="footer-verse">é¡˜ä»¥æ­¤åŠŸå¾·ï¼Œæ™®åŠæ–¼ä¸€åˆ‡ã€‚æˆ‘ç­‰èˆ‡çœ¾ç”Ÿï¼Œçš†å…±æˆä½›é“ã€‚â€”â€”ã€Šæ³•è¯ç¶“Â·åŒ–åŸå–»å“ã€‹</p>
        <p class="footer-credits">
            æ³•å°å°ç…§ v1.0 Â· ç¶“æ–‡
            <a href="https://www.cbeta.org" target="_blank" rel="noopener">CBETA</a> Â·
            äººç‰©
            <a href="https://authority.dila.edu.tw/" target="_blank" rel="noopener">DILA</a> Â·
            æºç¢¼
            <a href="https://github.com/maolibu/fa-yin" target="_blank" rel="noopener">GitHub â†—</a>
        </p>
    </footer>

    <script src="/static/js/app.js"></script>
    {% block scripts %}{% endblock %}
</body>

</html>